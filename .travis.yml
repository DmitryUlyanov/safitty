group: travis_latest
language: python
cache: pip
python:
  - 3.6

stages:
  - Codestyle
  - Test
  - Deploy

install: &requirements
  pip install -r requirements.txt

jobs:
  include:
  - stage: Codestyle
    install: pip install flake8
    script:
      - flake8 . --count --ignore=E126,E226,E704,E731,W503,W504,F405 --max-complexity=16
        --show-source --statistics --max-line-length=120

  - stage: Test
    install:
      - *requirements
      - pip install pytest
    script:
      - py.test tests/

  - stage: Deploy
    script: true
    deploy:
      provider: pypi
      user: $PYPI_USER
      password: $PYPI_PASS

      skip_cleanup: true
      skip_existing: true
      distributions: "sdist bdist_wheel"
      on:
        tags: true
        python: 3.6
env:
  global:
    secure: EHRHIL14hLC2mSU7F799jPUw3mT3frgljf/HOuhvJdSWT1V9aEjmyc7iMs+gNLa9V8fXHqeDHBAB0DUOX64auUWB52P58lt8UNubVrhIqq9Q1vm/eODVEfOKrLexh7PwIq++2h+x96jjhPS4cGdQ465Reg3tBCFalNffV0KkdVliGp7pjivHiOFlzRyIL8PsiFvq1TVmnPOnSEhL3CUXcvfsfrgnLuufR8BoV0+jtXUh6aHI9zbKILkPLO5w67t+nvCoNcRus5EiUfGWWG2HuIVAfPqSxa27Sgho3J+Oh5b3RCQ3QzAhUw6pMTr+uhsUW+Z4lovrOPtbvCwe+ZiK6JxLRRF1KxiBYwevJ7L6cIKYVz9fClhmouXqWbTLjdjc7ZWPBVaBsgPzaacaCx0j24quAU2zt/qI7SS8PWdhmSwtmbUbY7nowwcg6eIsCKZ2kJoml0lMzfYCVxZhc78RjC4XADaxCxaWjoTtVwzB2VvGDOkDf+p+itr7CqtGsuu1uXVpOMaOHmioOT2cSrVIn7NBYd62aXowV9bPTbrTZlph4aXRxODMVaapOxfXYHvqihMr8wxkFPB9pXUeUiFKlRPwOC+SDNPfCzj0CBGJmgcisk1FZ7jU+ZGqPWBENIJ56Oxfx6ys7bhyxvq4NqTw7HgTnoy1nUuykdCpGkCQqaE=
